<!-- Launch File Arguments -->
<!-- 1) simulation (false)-->
<!-- 2) use_sim_time (false)-->
<!-- 3) bringup (true)-->
<!-- 4) display (false)-->


<launch>
  <!-- Simulation: Set Argumet True if using for Simulation -->
  <arg name="simulation" default="false"/>
  <arg name="use_sim_time" default="false"/>

  <!-- General: Set Argumet True if haven't start ELA2.0 BRINGUP -->
  <arg name="bringup" default="true"/>

  <!-- General: ELA2.0 BRINGUP -->
  <group if="$(var bringup)">
    <include file="$(find-pkg-share ella2_bringup)/launch/ella2_bringup.launch.xml"/>
  </group>

  <!-- General: Set Argument True for RVIZ DISPLAY -->
  <arg name="display" default="false"/>

  <!-- General: Start RVIZ DISPLAY -->
  <let name="rviz_config_path" 
       value="$(find-pkg-share ella2_slam)/rviz/cartographer.rviz" />
  
  <group if="$(var display)">
    <node pkg="rviz2" exec="rviz2" output="screen" args="-d $(var rviz_config_path)"/>
  </group>

  <!-- General: Start Cartographer -->
  <include file="$(find-pkg-share ella2_slam)/launch/carto.launch.xml">
    <arg name="bringup" value="false"/>
    <arg name="display" value="false"/>
  </include>

  <!-- General: Start ORB-SLAM3 -->
  <include file="$(find-pkg-share ella2_slam)/launch/orbslam3.launch.xml"/>

  <!-- Simulation: Start Nav2 -->
  <group if="$(var simulation)">
    <include file="$(find-pkg-share nav2_bringup)/launch/navigation_launch.py">
      <arg name="params_file" value="$(find-pkg-share ella2_nav)/param/ella2_sim.yaml"/>
      <arg name="use_sim_time" value="true"/>
    </include>
  </group>

  <!-- Physical Robot: Start Nav2 -->
  <group unless="$(var simulation)">
    <include file="$(find-pkg-share nav2_bringup)/launch/navigation_launch.py">
      <arg name="params_file" value="$(find-pkg-share ella2_nav)/param/ella2.yaml"/>
      <arg name="use_sim_time" value="false"/>
    </include>
    
    <node pkg="ella2_twist_converter" exec="ella2_twist_converter_node"/> 
  </group>

</launch>
